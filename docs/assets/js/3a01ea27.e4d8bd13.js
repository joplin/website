"use strict";(self.webpackChunk_joplin_doc_builder=self.webpackChunk_joplin_doc_builder||[]).push([[4316],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),h=r,m=c["".concat(s,".").concat(h)]||c[h]||d[h]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},647:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return i},default:function(){return d},frontMatter:function(){return o},metadata:function(){return l},toc:function(){return u}});var a=n(7462),r=(n(7294),n(3905));const o={created:new Date("2021-11-02T15:04:03.000Z"),source_url:"https://www.patreon.com/posts/potential-change-58206692",sidebar_label:"Potential breaking change in next Joplin Server update (2.5.10)",date:new Date("2021-11-02T00:00:00.000Z"),title:"Potential breaking change in next Joplin Server update (2.5.10)",description:'Just a head up that the next Joplin Server update could potentially include a breaking change, depending on your data. One of the database migration is going to add an "owner_id" column to the "ite...'},i="Potential breaking change in next Joplin Server update (2.5.10)",l={permalink:"/news/20211102-150403",editUrl:"https://github.com/laurent22/joplin/tree/dev/readme/news/20211102-150403.md",source:"@site/news/20211102-150403.md",title:"Potential breaking change in next Joplin Server update (2.5.10)",description:'Just a head up that the next Joplin Server update could potentially include a breaking change, depending on your data. One of the database migration is going to add an "owner_id" column to the "ite...',date:"2021-11-02T00:00:00.000Z",formattedDate:"November 2, 2021",tags:[],readingTime:1.34,hasTruncateMarker:!1,authors:[],frontMatter:{created:"2021-11-02T15:04:03.000Z",source_url:"https://www.patreon.com/posts/potential-change-58206692",sidebar_label:"Potential breaking change in next Joplin Server update (2.5.10)",date:"2021-11-02T00:00:00.000Z",title:"Potential breaking change in next Joplin Server update (2.5.10)",description:'Just a head up that the next Joplin Server update could potentially include a breaking change, depending on your data. One of the database migration is going to add an "owner_id" column to the "ite...'},prevItem:{title:"Joplin 2.6 is available!",permalink:"/news/20211217-120324"},nextItem:{title:"Joplin v2.5 is available for desktop and mobile!",permalink:"/news/20211031-115215"}},s={authorsImageUrls:[]},u=[],p={toc:u},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"donate-links"},(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.paypal.com/donate/?business=E8JMYD2LQ8MMA&no_recurring=0&item_name=I+rely+on+donations+to+maintain+and+improve+the+Joplin+open+source+project.+Thank+you+for+your+help+-+it+makes+a+difference%21&currency_code=EUR"},(0,r.kt)("img",{parentName:"a",src:"https://raw.githubusercontent.com/laurent22/joplin/dev/Assets/WebsiteAssets/images/badges/Donate-PayPal-green.svg",alt:"Donate using PayPal"}))," ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/sponsors/laurent22/"},(0,r.kt)("img",{parentName:"a",src:"https://raw.githubusercontent.com/laurent22/joplin/dev/Assets/WebsiteAssets/images/badges/GitHub-Badge.svg",alt:"Sponsor on GitHub"}))," ",(0,r.kt)("a",{parentName:"p",href:"https://www.patreon.com/joplin"},(0,r.kt)("img",{parentName:"a",src:"https://raw.githubusercontent.com/laurent22/joplin/dev/Assets/WebsiteAssets/images/badges/Patreon-Badge.svg",alt:"Become a patron"}))," ",(0,r.kt)("a",{parentName:"p",href:"https://joplinapp.org/donate/#donations"},(0,r.kt)("img",{parentName:"a",src:"https://raw.githubusercontent.com/laurent22/joplin/dev/Assets/WebsiteAssets/images/badges/Donate-IBAN.svg",alt:"Donate using IBAN"})))),(0,r.kt)("p",null,"Just a head up that the next Joplin Server update could potentially include a breaking change, depending on your data."),(0,r.kt)("p",null,'One of the database migration is going to add an "owner_id" column to the "items" table (where all notes, notebooks, etc. are stored), and automatically populate it. Normally that shouldn\'t take too long but you might want to make sure you won\'t need the server right away when you process this.'),(0,r.kt)("p",null,"The second database migration will add a unique constraint on ",(0,r.kt)("a",{parentName:"p",href:"http://items.name"},"items.name")," and items.owner_id and that's where the breaking change might be. Normally this data is already unique because that's enforced by the application but in some rare cases, due a race condition, there could be duplicate data in there. If that happens the migration will fail and the server will not start."),(0,r.kt)("p",null,"If that happens, you'll need to decide what to do with the data, as it's not possible to automatically decide. You can find all duplicates using this query:"),(0,r.kt)("code",null,"**select** count(*), name, owner_id**from** items **group** **by** name, owner_id**having** count(*) > 1;"),(0,r.kt)("p",null,"Once you have the list of IDs you have a few options:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Find the corresponding item in Joplin (it can unfortunately be anything - a note, resource, folder, etc.), then delete it and sync."),(0,r.kt)("li",{parentName:"ul"},"Or, just delete the data directly in the database. You'll want to delete the corresponding item_id from the user_items table too.")),(0,r.kt)("p",null,"But really in most cases you should be fine. Especially if you don't have that many notes it's unlikely you have duplicates."))}d.isMDXComponent=!0}}]);